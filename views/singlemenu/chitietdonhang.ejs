<%- include('../inc/header-user.ejs') %>
<div style="margin-top: 80px; height: 100vh; margin-left: 320px; flex: 1">
  <form style="width: 500px" class="d-flex" method="post" action="/api/search">
    <input
      class="form-control me-2"
      type="search"
      name="search"
      placeholder="Search"
      aria-label="Search"
    />
    <button class="btn btn-outline-success" type="submit">Search</button>
  </form>

  <div class="table-container">
    <table class="table">
      <thead>
        <tr>
          <!-- Đã loại bỏ cột STT -->
          <th scope="col">Mã Đơn Hàng</th>
          <th scope="col">Tên người mua</th>
          <th scope="col">Số điện thoại</th>
          <th scope="col">Địa chỉ</th>
          <th scope="col">Tên sản phẩm</th>
          <th scope="col">Số lượng</th>
          <th scope="col">Đơn giá</th>
          <th scope="col">Thành tiền</th>
          <th scope="col">Tổng cộng</th>
        </tr>
      </thead>
      <tbody>
        <% for (let i = 0; i < data.product.length; i++) { %>
        <tr>
          <!-- Hiển thị chỉ 1 lần các cột gộp -->
          <% if (i === 0) { %>
            <td rowspan="<%= data.product.length %>"><%= data._id %></td>
            <td rowspan="<%= data.product.length %>"><%= data.username %></td>
            <td rowspan="<%= data.product.length %>"><%= data.phone %></td>
            <td rowspan="<%= data.product.length %>"><%= data.address %></td>
          <% } %>
          <!-- Hiển thị thông tin sản phẩm -->
          <td><%= data.product[i].name %></td>
          <td><%= data.product[i].quantity %></td>
          <td><%= data.product[i].price %></td>
          <td><%= data.product[i].quantity * data.product[i].price %></td>
          <% if (i === 0) { %>
            <td rowspan="<%= data.product.length %>"><%= data.totalPrice %></td>
          <% } %>
        </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</div>

<div style="margin-top: 100px;">
  <%- include('../inc/footer.ejs') %>
</div>

<style>
  /* CSS cho bảng */
  .table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
  }

  .table th, .table td {
    padding: 12px;
    text-align: center;
    border: 1px solid #ddd;
    vertical-align: middle;
  }

  .table th {
    background-color: #f4f4f4;
    font-weight: bold;
  }

  .table tr:nth-child(even) {
    background-color: #f9f9f9;
  }

  .table tr:hover {
    background-color: #f1f1f1;
  }

  .table-container {
    overflow-x: auto;
  }

  /* CSS cho các cột */
  .table th, .table td {
    min-width: 120px;
  }

  .table td {
    word-wrap: break-word;
  }

  .table td, .table th {
    text-align: center;
  }

  /* Thêm hiệu ứng khi rê chuột vào bảng */
  .table tbody tr:hover {
    background-color: #e6f7ff;
  }

  /* Tăng kích thước bảng trên màn hình nhỏ */
  @media (max-width: 768px) {
    .table th, .table td {
      font-size: 12px;
      padding: 8px;
    }
  }
</style>

<%- include('../inc/footer.ejs') %>
